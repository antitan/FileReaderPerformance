To start the ingestion process, it is required to log in to the Unique system. Authentication uses the basic mecanism, the user will get a token that has a limited life span (a few hours on test).
Sample curl:

curl --location --proxy 'http://192.168.128.128:8080' 'https://id.ubpai-evx.unique.app/oauth/v2/token' --header 'Authorization: Basic dWJwLWludHJhbmV0LWluZ2VzdGlvbjpMbmdaT3BrVmx6QTFjcjJHblN4TWk3OGRWamtkU01kcTVpWGNqYk1MSVBxcDFZdm9zWkNWdVlBbFBIZGpuYWph' --header 'Content-Type: application/x-www-form-urlencoded' --data-urlencode 'scope=openid profile email urn:zitadel:iam:user:resourceowner urn:zitadel:iam:org:projects:roles urn:zitadel:iam:org:project:id:266046375441993799:aud' --data-urlencode 'grant_type=client_credentials'
Using the token provided by the authentication, you can start the ingestion process:

Sample curl:

curl -v --location --proxy 'http://192.168.128.128:8080' 'https://gateway.ubpai-evx.unique.app/ingestion/graphql' --header 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IjI3NTE4ODYyNDk3NzMwMTUzMyIsInR5cCI6IkpXVCJ9.eyJhdWQiOlsiMjY2MDQ2Mzc1NDQxOTkzNzk5Il0sImV4cCI6MTcyMDU4MDUxNSwiaWF0IjoxNzIwNTM3MzE1LCJpc3MiOiJodHRwczovL2lkLnVicGFpLWV2eC51bmlxdWUuYXBwIiwianRpIjoiMjc1MjE1NjU4NzQyOTc2NjQ4IiwibmJmIjoxNzIwNTM3MzE1LCJzdWIiOiIyNzIxNjYxNjI2ODk2OTE2NTgiLCJ1cm46eml0YWRlbDppYW06b3JnOnByb2plY3Q6MjY2MDQ2Mzc1NDQxOTkzNzk5OnJvbGVzIjp7ImNoYXQua25vd2xlZGdlLnJlYWQiOnsiMjY2MjIwMDA1ODE5OTQ1MDM1IjoiZXZ4LXVicC5pZC51YnBhaS1ldngudW5pcXVlLmFwcCJ9LCJjaGF0Lmtub3dsZWRnZS53cml0ZSI6eyIyNjYyMjAwMDU4MTk5NDUwMzUiOiJldngtdWJwLmlkLnVicGFpLWV2eC51bmlxdWUuYXBwIn19LCJ1cm46eml0YWRlbDppYW06dXNlcjpyZXNvdXJjZW93bmVyOmlkIjoiMjY2MjIwMDA1ODE5OTQ1MDM1IiwidXJuOnppdGFkZWw6aWFtOnVzZXI6cmVzb3VyY2Vvd25lcjpuYW1lIjoiRVZYIFVCUCIsInVybjp6aXRhZGVsOmlhbTp1c2VyOnJlc291cmNlb3duZXI6cHJpbWFyeV9kb21haW4iOiJldngtdWJwLmlkLnVicGFpLWV2eC51bmlxdWUuYXBwIn0.K5EfEDIMGx3iKZ5RdAb5ZVKFS2I_LwF156kco7HiXNSIjHgMNhwnevqiivbkOya8-LYobIcNBmIo-YTf53bFcieDPwPwe71Bs36piXLgqfF--NjFA-mJOtwnYL_aTBc2oqtT-dqyB1bHITTmeKCkYvkHKJNmmr7F2HBSHNsxgQUK-PDxKR1fXC48FcrR7kXk7JTZKbbvCGXcokGHHSgrAxLEU1wv-YctIMpEhugjCTcLei3uOBc1Q683HCtuVLBkYwU_V39AIuqDvnSOHo7-8WOnlRMk4MMd6vCS6oZFb4YtJf3itnHswhslHO9lZ3cAM7hvnjlFuv2EIX3zrpHStw' --header 'Content-Type: application/json' --data '{"query":"mutation ContentUpsert($input: ContentCreateInput!, $fileUrl: String, $chatId: String, $scopeId: String, $sourceOwnerType: String, $sourceName: String, $sourceKind: String, $storeInternally: Boolean) {\r\n  contentUpsert(\r\n    input: $input\r\n    fileUrl: $fileUrl\r\n    chatId: $chatId\r\n    scopeId: $scopeId\r\n    sourceOwnerType: $sourceOwnerType\r\n    sourceName: $sourceName\r\n    sourceKind: $sourceKind\r\n    storeInternally: $storeInternally\r\n  ) {\r\n    id\r\n    key\r\n    byteSize\r\n    mimeType\r\n    ownerType\r\n    ownerId\r\n    writeUrl\r\n    readUrl\r\n    createdAt\r\n    internallyStoredAt\r\n  }\r\n}","variables":{"input":{"key":"KYG7871M1050_EN.pdf","mimeType":"application/pdf","ownerType":"SCOPE"},"sourceOwnerType":"USER","scopeId":"scope_rgn6jn1eauem1r4um9gem0n1","storeInternally":true}}'
In the JSON response, you'll get a writeUrl field that you'll use to upload the document. This URL can be called using the PUT HTTP method with a raw binary content.


Sample curl:

curl -v --location --request PUT --proxy 'http://192.168.128.128:8080' 'https://uqtreeevxingestioncache.blob.core.windows.net/ingestion/266220005819945035/cont_eauunoye1pmv8hsae6r6xq27?sv=2023-08-03&spr=https&st=2024-06-20T13%3A25%3A19Z&se=2024-06-20T13%3A45%3A19Z&sr=b&sp=w&sig=tJdOlKkC%2BY1V%2FTNLpfP%2Fl0VI2AxQlFVpOk%2BuVxsboUk%3D' --header 'x-ms-blob-type: BlockBlob' --header 'Content-Type: application/pdf' --data KYG7871M1050_EN.pdf
